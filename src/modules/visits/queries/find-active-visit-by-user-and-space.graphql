query findActiveVisitByUserAndSpace(
	$userProfileId: uuid
	$maintainerOrgId: String
	$now: timestamp
) {
	cp_visit(
		where: {
			user_profile_id: { _eq: $userProfileId }
			status: { _eq: "APPROVED" }
			start_date: { _lte: $now }
			end_date: { _gte: $now }
			space: { schema_maintainer_id: { _ilike: $maintainerOrgId } }
		}
	) {
		id
		cp_space_id
		user_profile_id
		user_profile {
			id
			full_name
			first_name
			last_name
			mail
		}
		user_reason
		user_timeframe
		status
		start_date
		end_date
		notes(order_by: { created_at: desc }, limit: 1) {
			id
			note
			profile {
				full_name
			}
			created_at
		}
		created_at
		updated_at
		updater {
			id
			full_name
		}
		space {
			id
			schema_image
			schema_color
			schema_audience_type
			schema_description
			schema_public_access
			schema_service_description
			is_published
			published_at
			created_at
			updated_at
			schema_maintainer {
				schema_name
				schema_identifier
				information {
					description
					logo {
						iri
					}
					primary_site {
						address {
							email
							locality
							postal_code
							street
							telephone
							post_office_box_number
						}
					}
				}
			}
		}
	}
}
